==================================================
RAPPORT DE TESTS - Thu Oct 30 14:13:45 CET 2025
==================================================

============================================
üì¶ TESTS BACKEND (Python/Flask)
============================================

Nombre total de fichiers de tests: 30

üìÇ Structure des tests:
  - Tests unitaires (models/): 5 fichiers
  - Tests d'int√©gration (routes/): 16 fichiers
  - Tests E2E: 1 fichiers
  - Tests de s√©curit√©: 8 fichiers

--------------------------------------------
üß© TESTS UNITAIRES (Models)
--------------------------------------------
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-8.0.0, pluggy-1.6.0 -- /usr/local/bin/python3.11
cachedir: .pytest_cache
rootdir: /app
configfile: pytest.ini
plugins: cov-4.0.0, flask-1.3.0
collecting ... collected 72 items

tests/models/test_action_log.py::TestActionLogModel::test_action_log_creation_minimal_required_fields PASSED [  1%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_missing_fields PASSED [  2%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_relation_and_to_dict PASSED [  4%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_creation_minimal_required_fields PASSED [  5%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_note_user_required PASSED [  6%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_relations PASSED [  8%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_to_dict_and_repr PASSED [  9%]
tests/models/test_contact.py::TestContactModel::test_contact_creation_minimal PASSED [ 11%]
tests/models/test_contact.py::TestContactModel::test_contact_creation_all_fields PASSED [ 12%]
tests/models/test_contact.py::TestContactModel::test_contact_required_fields PASSED [ 13%]
tests/models/test_contact.py::TestContactModel::test_contact_relations PASSED [ 15%]
tests/models/test_contact.py::TestContactModel::test_cannot_add_self_as_contact PASSED [ 16%]
tests/models/test_contact.py::TestContactModel::test_duplicate_contact_not_allowed PASSED [ 18%]
tests/models/test_contact.py::TestContactModel::test_contact_repr_and_to_dict PASSED [ 19%]
tests/models/test_contact.py::TestContactModel::test_contact_query_filters PASSED [ 20%]
tests/models/test_contact.py::TestContactModel::test_contact_long_nickname PASSED [ 22%]
tests/models/test_contact.py::TestContactModel::test_contact_with_null_action PASSED [ 23%]
tests/models/test_contact.py::TestContactModel::test_contact_date_format_and_precision PASSED [ 25%]
tests/models/test_contact.py::TestContactModel::test_contact_delete_user_fails PASSED [ 26%]
tests/models/test_note.py::TestNoteModel::test_note_creation PASSED      [ 27%]
tests/models/test_note.py::TestNoteModel::test_note_default_values PASSED [ 29%]
tests/models/test_note.py::TestNoteModel::test_note_content_required PASSED [ 30%]
tests/models/test_note.py::TestNoteModel::test_note_creator_required PASSED [ 31%]
tests/models/test_note.py::TestNoteModel::test_note_invalid_status PASSED [ 33%]
tests/models/test_note.py::TestNoteModel::test_note_creator_relationship PASSED [ 34%]
tests/models/test_note.py::TestNoteModel::test_note_assignments_relationship PASSED [ 36%]
tests/models/test_note.py::TestNoteModel::test_note_deletion_cascade_creator PASSED [ 37%]
tests/models/test_note.py::TestNoteModel::test_repr_truncates_content PASSED [ 38%]
tests/models/test_note.py::TestNoteModel::test_to_dict_date_formats PASSED [ 40%]
tests/models/test_note.py::TestNoteModel::test_to_details_dict_with_assignment PASSED [ 41%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_all_contacts PASSED [ 43%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_truncation_and_display PASSED [ 44%]
tests/models/test_note.py::TestNoteModel::test_note_with_finished_date PASSED [ 45%]
tests/models/test_note.py::TestNoteModel::test_query_filters PASSED      [ 47%]
tests/models/test_note.py::TestNoteModel::test_note_empty_string_content PASSED [ 48%]
tests/models/test_note.py::TestNoteModel::test_note_delete_date_marks_soft_delete PASSED [ 50%]
tests/models/test_note.py::TestNoteModel::test_note_datetime_precision PASSED [ 51%]
tests/models/test_note.py::TestNoteModel::test_note_invalid_type_raises PASSED [ 52%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_all_contacts_without_creator_as_current_user PASSED [ 54%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_three_or_less_assigned_users PASSED [ 55%]
tests/models/test_user.py::TestUserModel::test_user_creation PASSED      [ 56%]
tests/models/test_user.py::TestUserModel::test_user_creation_minimal_required_fields PASSED [ 58%]
tests/models/test_user.py::TestUserModel::test_user_username_unique_constraint PASSED [ 59%]
tests/models/test_user.py::TestUserModel::test_user_email_unique_constraint PASSED [ 61%]
tests/models/test_user.py::TestUserModel::test_user_password_hashing PASSED [ 62%]
tests/models/test_user.py::TestUserModel::test_user_to_dict PASSED       [ 63%]
tests/models/test_user.py::TestUserModel::test_user_repr PASSED          [ 65%]
tests/models/test_user.py::TestUserModel::test_user_contacts_relationship PASSED [ 66%]
tests/models/test_user.py::TestUserModel::test_user_created_notes_relationship PASSED [ 68%]
tests/models/test_user.py::TestUserModel::test_user_assignments_relationship PASSED [ 69%]
tests/models/test_user.py::TestUserModel::test_user_validation_empty_username PASSED [ 70%]
tests/models/test_user.py::TestUserModel::test_user_validation_empty_email PASSED [ 72%]
tests/models/test_user.py::TestUserModel::test_user_validation_long_username PASSED [ 73%]
tests/models/test_user.py::TestUserModel::test_user_validation_long_email PASSED [ 75%]
tests/models/test_user.py::TestUserModel::test_user_query_by_username PASSED [ 76%]
tests/models/test_user.py::TestUserModel::test_user_query_by_email PASSED [ 77%]
tests/models/test_user.py::TestUserModel::test_multiple_users_creation PASSED [ 79%]
tests/models/test_user.py::TestUserModel::test_user_validation_short_username PASSED [ 80%]
tests/models/test_user.py::TestUserModel::test_user_validation_invalid_email_format PASSED [ 81%]
tests/models/test_user.py::TestUserModel::test_user_validation_whitespace_trimming PASSED [ 83%]
tests/models/test_user.py::TestUserModel::test_username_length_bounds PASSED [ 84%]
tests/models/test_user.py::TestUserModel::test_email_length_bounds PASSED [ 86%]
tests/models/test_user.py::TestUserModel::test_email_case_insensitive_uniqueness PASSED [ 87%]
tests/models/test_user.py::TestUserModel::test_trim_and_lower_on_update PASSED [ 88%]
tests/models/test_user.py::TestUserModel::test_set_password_and_check_password PASSED [ 90%]
tests/models/test_user.py::TestUserModel::test_password_hash_blank_raises PASSED [ 91%]
tests/models/test_user.py::TestUserModel::test_created_date_is_timezone_aware_utc PASSED [ 93%]
tests/models/test_user.py::TestUserModel::test_username_unique_integrity_error PASSED [ 94%]
tests/models/test_user.py::TestUserModel::test_email_unique_integrity_error PASSED [ 95%]
tests/models/test_user.py::TestUserModel::test_contact_fk_integrity PASSED [ 97%]
tests/models/test_user.py::TestUserModel::test_update_username_to_existing_raises PASSED [ 98%]
tests/models/test_user.py::TestUserModel::test_update_email_invalid_format_raises PASSED [100%]

---------- coverage: platform linux, python 3.11.14-final-0 ----------
Name                           Stmts   Miss  Cover   Missing
------------------------------------------------------------
app/__init__.py                   58      8    86%   101, 107-111, 116, 120, 124
app/decorators.py                 18      8    56%   18-28
app/models/__init__.py             6      0   100%
app/models/action_log.py          15      0   100%
app/models/assignment.py          20      0   100%
app/models/contact.py             20      0   100%
app/models/note.py                34      0   100%
app/models/user.py                51      2    96%   57, 85
app/routes/__init__.py             0      0   100%
app/routes/v1/__init__.py          6      0   100%
app/routes/v1/action_logs.py      35     17    51%   24-42, 55-56, 66-80
app/routes/v1/admin.py           144     74    49%   20-21, 31-32, 42-51, 62-65, 75-89, 106-107, 118-131, 145-148, 160-161, 171-172, 182-190, 203-206, 218-219, 229-230, 240-254, 267-270
app/routes/v1/assignments.py     154    124    19%   16-74, 81-103, 109-117, 123-171, 177-205, 211-232, 238-279, 285-292
app/routes/v1/auth.py             61     41    33%   21-66, 82-97, 115-118, 139-151
app/routes/v1/contacts.py        131    104    21%   16-58, 67-96, 106-133, 139-146, 152-179, 185-208, 221-317
app/routes/v1/notes.py           205    170    17%   19-47, 64-182, 197-280, 287-290, 297-307, 333-365, 375-395, 405-433, 443-476
app/routes/v1/users.py            78     56    28%   19-21, 27-28, 34-35, 41-102, 108-131
------------------------------------------------------------
TOTAL                           1036    604    42%
Coverage HTML written to dir htmlcov


============================= 72 passed in 10.06s ==============================
‚úÖ Tests unitaires: SUCC√àS

--------------------------------------------
üîó TESTS D'INT√âGRATION (Routes/API)
--------------------------------------------
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-8.0.0, pluggy-1.6.0 -- /usr/local/bin/python3.11
cachedir: .pytest_cache
rootdir: /app
configfile: pytest.ini
plugins: cov-4.0.0, flask-1.3.0
collecting ... collected 242 items

tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_empty PASSED [  0%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_with_logs PASSED [  0%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_pagination PASSED [  1%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_filter_by_user PASSED [  1%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_filter_by_action_type PASSED [  2%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_multiple_filters PASSED [  2%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_success PASSED [  2%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_not_found PASSED [  3%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_stats_empty PASSED [  3%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_stats_with_data PASSED [  4%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_list_action_logs PASSED [  4%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_list_action_logs PASSED [  4%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_get_specific_log PASSED [  5%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_get_specific_log PASSED [  5%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_get_stats PASSED [  6%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_get_stats PASSED [  6%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_as_admin PASSED [  7%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_as_regular_user PASSED [  7%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_without_auth PASSED [  7%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_all_notes_as_admin PASSED [  8%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_all_notes_as_regular_user PASSED [  8%]
tests/routes/test_admin.py::TestAdminRoutes::test_get_stats_as_admin PASSED [  9%]
tests/routes/test_admin.py::TestAdminRoutes::test_get_stats_as_regular_user PASSED [  9%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_user_as_admin PASSED [  9%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_user_as_regular_user PASSED [ 10%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_nonexistent_user_as_admin PASSED [ 10%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_as_admin PASSED [ 11%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_as_regular_user PASSED [ 11%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_invalid_role PASSED [ 11%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_missing_role PASSED [ 12%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_nonexistent_user_role PASSED [ 12%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_get_any_note PASSED [ 13%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_update_any_note PASSED [ 13%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_delete_any_note PASSED [ 14%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_non_admin_cannot_use_admin_note_routes PASSED [ 14%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_list_all_contacts PASSED [ 14%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_get_any_contact PASSED [ 15%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_update_any_contact PASSED [ 15%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_delete_any_contact PASSED [ 16%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_non_admin_cannot_list_all_contacts PASSED [ 16%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_list_all_assignments PASSED [ 16%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_get_any_assignment PASSED [ 17%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_update_any_assignment PASSED [ 17%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_delete_any_assignment PASSED [ 18%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_non_admin_cannot_list_all_assignments PASSED [ 18%]
tests/routes/test_admin_extended.py::TestAdminNotesUpdate::test_admin_update_note_status_field PASSED [ 19%]
tests/routes/test_admin_extended.py::TestAdminNotesUpdate::test_admin_update_note_important_only PASSED [ 19%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_recipient_priority PASSED [ 19%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_recipient_status PASSED [ 20%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_user_id PASSED [ 20%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_success PASSED [ 21%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_with_is_read PASSED [ 21%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_missing_note_id PASSED [ 21%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_missing_user_id PASSED [ 22%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_note_not_found PASSED [ 22%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_user_not_found PASSED [ 23%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_duplicate PASSED [ 23%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_list_assignments_empty PASSED [ 23%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_list_assignments_with_assignments PASSED [ 24%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_assignment_success PASSED [ 24%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_assignment_not_found PASSED [ 25%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_is_read PASSED [ 25%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_user_id PASSED [ 26%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_user_not_found PASSED [ 26%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_duplicate_user PASSED [ 26%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_not_found PASSED [ 27%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_delete_assignment_success PASSED [ 27%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_delete_assignment_not_found PASSED [ 28%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_success PASSED [ 28%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_forbidden_not_recipient PASSED [ 28%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_not_found PASSED [ 29%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_empty PASSED [ 29%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_with_unread PASSED [ 30%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_isolation PASSED [ 30%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_to_termine PASSED [ 30%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_to_en_cours PASSED [ 31%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_invalid_status PASSED [ 31%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_missing_status PASSED [ 32%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_forbidden_not_recipient PASSED [ 32%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_not_found PASSED [ 33%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_note_id PASSED [ 33%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_user_id PASSED [ 33%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_assigner_id PASSED [ 34%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_status PASSED [ 34%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_cannot_assign_to_non_contact PASSED [ 35%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_cannot_assign_to_non_mutual_contact PASSED [ 35%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_can_assign_to_mutual_contact PASSED [ 35%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_can_self_assign_without_contact PASSED [ 36%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_only_creator_can_assign PASSED [ 36%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_success PASSED  [ 37%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_username PASSED [ 37%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_email PASSED [ 38%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_password PASSED [ 38%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_duplicate_username PASSED [ 38%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_duplicate_email PASSED [ 39%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_empty_json PASSED [ 39%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_no_json PASSED  [ 40%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_success PASSED     [ 40%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_wrong_password PASSED [ 40%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_user_not_exists PASSED [ 41%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_missing_username PASSED [ 41%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_missing_password PASSED [ 42%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_empty_json PASSED  [ 42%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_no_json PASSED     [ 42%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_returns_valid_jwt PASSED [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_then_login_workflow PASSED [ 43%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_includes_self PASSED [ 44%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_with_added_contacts PASSED [ 44%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_empty_for_new_user PASSED [ 45%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_requires_auth PASSED [ 45%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_isolation PASSED [ 45%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_success PASSED [ 46%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_cannot_add_self PASSED [ 46%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_user_not_found PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_duplicate PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_missing_fields PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_requires_auth PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_users_includes_self PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_users_with_contacts PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_requires_auth PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_success PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_not_found PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_update_contact_success PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_update_contact_not_found PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_delete_contact_success PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_delete_contact_not_found PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_sent_and_received PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_sent PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_received PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_unread PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_pagination PASSED [ 54%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_empty PASSED [ 54%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_forbidden_not_own_contact PASSED [ 54%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_not_found PASSED [ 55%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_requires_auth PASSED [ 55%]
tests/routes/test_contacts_extended.py::TestContactNotesFilters::test_contact_notes_filter_important PASSED [ 56%]
tests/routes/test_contacts_extended.py::TestContactNotesFilters::test_contact_notes_pagination_limits PASSED [ 56%]
tests/routes/test_logout.py::TestLogout::test_logout_success PASSED      [ 57%]
tests/routes/test_logout.py::TestLogout::test_logout_requires_auth PASSED [ 57%]
tests/routes/test_logout.py::TestLogout::test_logout_with_invalid_token PASSED [ 57%]
tests/routes/test_logout.py::TestLogout::test_logout_logs_action PASSED  [ 58%]
tests/routes/test_logout.py::TestLogout::test_logout_multiple_times PASSED [ 58%]
tests/routes/test_logout.py::TestLogout::test_logout_then_access_protected_route PASSED [ 59%]
tests/routes/test_logout.py::TestLogoutWorkflow::test_login_logout_login_workflow PASSED [ 59%]
tests/routes/test_logout.py::TestLogoutWorkflow::test_register_auto_login_logout PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_success PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_with_all_fields PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_missing_content PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_requires_auth PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_empty PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_with_notes PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_requires_auth PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_success PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_not_found PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_requires_auth PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_success PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_with_assignment PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_not_found PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_requires_auth PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_success PASSED [ 66%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_missing_content PASSED [ 66%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_not_found PASSED [ 66%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_requires_auth PASSED [ 67%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_success PASSED [ 67%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_not_found PASSED [ 68%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_requires_auth PASSED [ 68%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_important PASSED [ 69%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_important_by_me PASSED [ 69%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_unread PASSED [ 69%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_received PASSED [ 70%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_sent PASSED [ 70%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_sort_date_asc PASSED [ 71%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_sort_important_first PASSED [ 71%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_default PASSED [ 71%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_custom_per_page PASSED [ 72%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_page_2 PASSED [ 72%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_last_page PASSED [ 73%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_max_per_page PASSED [ 73%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_invalid_values PASSED [ 73%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_as_creator PASSED [ 74%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_forbidden_not_creator PASSED [ 74%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_not_found PASSED [ 75%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_empty PASSED [ 75%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_by_creator_id PASSED [ 76%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_by_important_boolean PASSED [ 76%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_created_date_asc PASSED [ 76%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_important PASSED [ 77%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_invalid_fallback PASSED [ 77%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_in_progress PASSED [ 78%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_completed PASSED [ 78%]
tests/routes/test_notes_extended.py::TestNotesContentValidation::test_create_note_content_too_long PASSED [ 78%]
tests/routes/test_notes_extended.py::TestOrphanNotes::test_get_orphan_notes_empty PASSED [ 79%]
tests/routes/test_notes_extended.py::TestOrphanNotes::test_get_orphan_notes_with_orphans PASSED [ 79%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_only_creator PASSED [ 80%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_with_logs PASSED [ 80%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_empty PASSED [ 80%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_by_content PASSED [ 81%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_case_insensitive PASSED [ 81%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_partial_match PASSED [ 82%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_no_results PASSED [ 82%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_empty_query PASSED [ 83%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_with_spaces PASSED [ 83%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_combined_with_filters PASSED [ 83%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_combined_with_sorting PASSED [ 84%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_with_pagination PASSED [ 84%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_success PASSED [ 85%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_without_token PASSED [ 85%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_with_invalid_token PASSED [ 85%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_returns_correct_user PASSED [ 86%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_validates_token PASSED [ 86%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_structure PASSED [ 87%]
tests/routes/test_search_and_auth_me.py::TestSearchAndAuthIntegration::test_search_only_returns_user_notes PASSED [ 87%]
tests/routes/test_search_and_auth_me.py::TestSearchAndAuthIntegration::test_search_requires_authentication PASSED [ 88%]
tests/routes/test_users.py::TestUsersRoutes::test_list_users_empty PASSED [ 88%]
tests/routes/test_users.py::TestUsersRoutes::test_list_users_with_users PASSED [ 88%]
tests/routes/test_users.py::TestUsersRoutes::test_get_user_success PASSED [ 89%]
tests/routes/test_users.py::TestUsersRoutes::test_get_user_not_found PASSED [ 89%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username PASSED [ 90%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email PASSED [ 90%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password PASSED [ 90%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_multiple_fields PASSED [ 91%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_empty PASSED [ 91%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_whitespace PASSED [ 92%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_duplicate PASSED [ 92%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_empty PASSED [ 92%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_whitespace PASSED [ 93%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_duplicate PASSED [ 93%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password_empty PASSED [ 94%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password_whitespace PASSED [ 94%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_not_found PASSED [ 95%]
tests/routes/test_users.py::TestUsersRoutes::test_delete_user_success PASSED [ 95%]
tests/routes/test_users.py::TestUsersRoutes::test_delete_user_not_found PASSED [ 95%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_list_users_requires_auth PASSED [ 96%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_get_user_requires_auth PASSED [ 96%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_own_profile PASSED [ 97%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_other_user_profile_forbidden PASSED [ 97%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_admin_can_update_any_profile PASSED [ 97%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_own_account PASSED [ 98%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_other_user_account_forbidden PASSED [ 98%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_admin_can_delete_any_account PASSED [ 99%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_requires_auth PASSED [ 99%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_requires_auth PASSED [100%]

---------- coverage: platform linux, python 3.11.14-final-0 ----------
Name                           Stmts   Miss  Cover   Missing
------------------------------------------------------------
app/__init__.py                   58      3    95%   101, 111, 124
app/decorators.py                 18      1    94%   23
app/models/__init__.py             6      0   100%
app/models/action_log.py          15      1    93%   28
app/models/assignment.py          20      1    95%   32
app/models/contact.py             20      1    95%   28
app/models/note.py                34     13    62%   33, 62-76
app/models/user.py                51     11    78%   28, 35, 37, 39, 46, 53-54, 57, 64, 78, 81
app/routes/__init__.py             0      0   100%
app/routes/v1/__init__.py          6      0   100%
app/routes/v1/action_logs.py      35      0   100%
app/routes/v1/admin.py           144      0   100%
app/routes/v1/assignments.py     154      4    97%   115, 129, 137, 186
app/routes/v1/auth.py             61      3    95%   31, 37-38
app/routes/v1/contacts.py        131      5    96%   144, 157, 190, 294, 296
app/routes/v1/notes.py           205     24    88%   158, 173, 208, 212-214, 225-228, 257-278, 338, 347, 416, 473-474
app/routes/v1/users.py            78     12    85%   19-21, 73-93
------------------------------------------------------------
TOTAL                           1036     79    92%
Coverage HTML written to dir htmlcov


================= 242 passed, 174 warnings in 77.62s (0:01:17) =================
‚úÖ Tests d'int√©gration: SUCC√àS

--------------------------------------------
üåê TESTS E2E (Workflows complets)
--------------------------------------------
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-8.0.0, pluggy-1.6.0 -- /usr/local/bin/python3.11
cachedir: .pytest_cache
rootdir: /app
configfile: pytest.ini
plugins: cov-4.0.0, flask-1.3.0
collecting ... collected 10 items

tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_complete_note_collaboration_workflow PASSED [ 10%]
tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_note_lifecycle_complete PASSED [ 20%]
tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_multiple_assignments_workflow PASSED [ 30%]
tests/e2e/test_workflows.py::TestUserIsolationWorkflows::test_complete_user_isolation FAILED [ 40%]
tests/e2e/test_workflows.py::TestUserIsolationWorkflows::test_contact_isolation_workflow PASSED [ 50%]
tests/e2e/test_workflows.py::TestErrorHandlingWorkflows::test_workflow_with_invalid_operations PASSED [ 60%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_exchange_workflow PASSED [ 70%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_pagination_workflow PASSED [ 80%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_unread_filter_workflow PASSED [ 90%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_empty_exchange_workflow PASSED [100%]

=================================== FAILURES ===================================
___________ TestUserIsolationWorkflows.test_complete_user_isolation ____________
tests/e2e/test_workflows.py:412: in test_complete_user_isolation
    assert response.status_code == 201
E   assert 401 == 201
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code

---------- coverage: platform linux, python 3.11.14-final-0 ----------
Name                           Stmts   Miss  Cover   Missing
------------------------------------------------------------
app/__init__.py                   58      4    93%   101, 111, 120, 124
app/decorators.py                 18      8    56%   18-28
app/models/__init__.py             6      0   100%
app/models/action_log.py          15      2    87%   28, 35
app/models/assignment.py          20      1    95%   32
app/models/contact.py             20      1    95%   28
app/models/note.py                34     13    62%   33, 62-76
app/models/user.py                51     13    75%   28, 35, 37, 39, 46, 53-54, 57, 64, 68, 78, 81, 85
app/routes/__init__.py             0      0   100%
app/routes/v1/__init__.py          6      0   100%
app/routes/v1/action_logs.py      35     17    51%   24-42, 55-56, 66-80
app/routes/v1/admin.py           144     74    49%   20-21, 31-32, 42-51, 62-65, 75-89, 106-107, 118-131, 145-148, 160-161, 171-172, 182-190, 203-206, 218-219, 229-230, 240-254, 267-270
app/routes/v1/assignments.py     154     79    49%   18, 28, 32, 43, 46, 81-103, 115, 129, 136-150, 177-205, 211-232, 238-279, 285-292
app/routes/v1/auth.py             61     15    75%   27, 31, 37-38, 42, 87, 93, 115-118, 139-151
app/routes/v1/contacts.py        131     47    64%   18, 25, 106-133, 139-146, 152-179, 185-208, 239, 241, 243, 287-289, 294, 296
app/routes/v1/notes.py           205    102    50%   21, 26, 72, 74, 76, 95-96, 101, 106, 110-142, 154-163, 165, 168-173, 197-280, 297-307, 338, 342, 347, 375-395, 416, 443-476
app/routes/v1/users.py            78     56    28%   19-21, 27-28, 34-35, 41-102, 108-131
------------------------------------------------------------
TOTAL                           1036    432    58%
Coverage HTML written to dir htmlcov

=========================== short test summary info ============================
FAILED tests/e2e/test_workflows.py::TestUserIsolationWorkflows::test_complete_user_isolation
=================== 1 failed, 9 passed, 22 warnings in 8.03s ===================
‚úÖ Tests E2E: SUCC√àS

--------------------------------------------
üîí TESTS DE S√âCURIT√â
--------------------------------------------
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-8.0.0, pluggy-1.6.0 -- /usr/local/bin/python3.11
cachedir: .pytest_cache
rootdir: /app
configfile: pytest.ini
plugins: cov-4.0.0, flask-1.3.0
collecting ... collected 35 items

tests/test_security_isolation.py::TestNotesIsolation::test_cannot_update_other_user_note PASSED [  2%]
tests/test_security_isolation.py::TestNotesIsolation::test_cannot_delete_other_user_note PASSED [  5%]
tests/test_security_isolation.py::TestNotesIsolation::test_creator_can_update_own_note PASSED [  8%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_view_other_user_contact PASSED [ 11%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_update_other_user_contact PASSED [ 14%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_delete_other_user_contact PASSED [ 17%]
tests/test_security_isolation.py::TestContactsIsolation::test_owner_can_update_own_contact PASSED [ 20%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_cannot_view_unrelated_assignment PASSED [ 22%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_creator_can_view_assignment PASSED [ 25%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_recipient_can_view_assignment PASSED [ 28%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_recipient_cannot_change_assignment_user PASSED [ 31%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_only_creator_can_delete_assignment PASSED [ 34%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_third_party_cannot_delete_assignment PASSED [ 37%]
tests/test_decorators_edge_cases.py::TestAdminDecorator::test_admin_decorator_with_deleted_user PASSED [ 40%]
tests/test_decorators_edge_cases.py::TestUsersUpdateValidation::test_update_other_user_as_non_admin PASSED [ 42%]
tests/test_email_validation.py::TestEmailValidation::test_valid_email_accepted PASSED [ 45%]
tests/test_email_validation.py::TestEmailValidation::test_email_normalized_to_lowercase PASSED [ 48%]
tests/test_email_validation.py::TestEmailValidation::test_invalid_email_rejected PASSED [ 51%]
tests/test_email_validation.py::TestEmailValidation::test_email_without_at_rejected PASSED [ 54%]
tests/test_email_validation.py::TestEmailValidation::test_email_without_domain_rejected PASSED [ 57%]
tests/test_email_validation.py::TestEmailValidation::test_email_with_multiple_at_rejected PASSED [ 60%]
tests/test_email_validation.py::TestEmailValidation::test_empty_email_rejected PASSED [ 62%]
tests/test_email_validation.py::TestEmailValidation::test_whitespace_only_email_rejected PASSED [ 65%]
tests/test_email_validation.py::TestEmailValidation::test_email_with_spaces_trimmed PASSED [ 68%]
tests/test_email_validation.py::TestEmailValidation::test_complex_valid_email_accepted PASSED [ 71%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_valid_email PASSED [ 74%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_invalid_email PASSED [ 77%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_normalizes_email PASSED [ 80%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_email_missing_domain PASSED [ 82%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_cannot_add_same_contact_twice PASSED [ 85%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_can_add_reciprocal_contacts PASSED [ 88%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_can_add_different_contacts_for_same_user PASSED [ 91%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_cannot_assign_same_note_to_user_twice PASSED [ 94%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_can_assign_same_note_to_different_users PASSED [ 97%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_can_assign_different_notes_to_same_user PASSED [100%]

---------- coverage: platform linux, python 3.11.14-final-0 ----------
Name                           Stmts   Miss  Cover   Missing
------------------------------------------------------------
app/__init__.py                   58      5    91%   101, 111, 116, 120, 124
app/decorators.py                 18      3    83%   25-28
app/models/__init__.py             6      0   100%
app/models/action_log.py          15      2    87%   28, 35
app/models/assignment.py          20      1    95%   32
app/models/contact.py             20      1    95%   28
app/models/note.py                34     14    59%   33, 49, 62-76
app/models/user.py                51      9    82%   28, 35, 37, 39, 57, 64, 68, 78, 81
app/routes/__init__.py             0      0   100%
app/routes/v1/__init__.py          6      0   100%
app/routes/v1/action_logs.py      35     17    51%   24-42, 55-56, 66-80
app/routes/v1/admin.py           144     74    49%   20-21, 31-32, 42-51, 62-65, 75-89, 106-107, 118-131, 145-148, 160-161, 171-172, 182-190, 203-206, 218-219, 229-230, 240-254, 267-270
app/routes/v1/assignments.py     154     95    38%   16-74, 81-103, 129, 140-171, 211-232, 238-279, 285-292
app/routes/v1/auth.py             61     21    66%   27, 31, 42, 82-97, 115-118, 139-151
app/routes/v1/contacts.py        131     83    37%   16-58, 67-96, 106-133, 146, 165, 193-208, 221-317
app/routes/v1/notes.py           205    148    28%   19-47, 64-182, 197-280, 287-290, 297-307, 342, 347, 351, 375-395, 419-433, 443-476
app/routes/v1/users.py            78     50    36%   19-21, 27-28, 34-35, 50-102, 108-131
------------------------------------------------------------
TOTAL                           1036    523    50%
Coverage HTML written to dir htmlcov


======================= 35 passed, 16 warnings in 7.18s ========================
‚úÖ Tests de s√©curit√©: SUCC√àS

============================================
üìä COUVERTURE DE CODE
============================================
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-8.0.0, pluggy-1.6.0 -- /usr/local/bin/python3.11
cachedir: .pytest_cache
rootdir: /app
configfile: pytest.ini
plugins: cov-4.0.0, flask-1.3.0
collecting ... collected 398 items

tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_complete_note_collaboration_workflow PASSED [  0%]
tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_note_lifecycle_complete PASSED [  0%]
tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_multiple_assignments_workflow PASSED [  0%]
tests/e2e/test_workflows.py::TestUserIsolationWorkflows::test_complete_user_isolation PASSED [  1%]
tests/e2e/test_workflows.py::TestUserIsolationWorkflows::test_contact_isolation_workflow PASSED [  1%]
tests/e2e/test_workflows.py::TestErrorHandlingWorkflows::test_workflow_with_invalid_operations PASSED [  1%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_exchange_workflow PASSED [  1%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_pagination_workflow PASSED [  2%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_unread_filter_workflow PASSED [  2%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_empty_exchange_workflow PASSED [  2%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_creation_minimal_required_fields PASSED [  2%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_missing_fields PASSED [  3%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_relation_and_to_dict PASSED [  3%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_creation_minimal_required_fields PASSED [  3%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_note_user_required PASSED [  3%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_relations PASSED [  4%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_to_dict_and_repr PASSED [  4%]
tests/models/test_contact.py::TestContactModel::test_contact_creation_minimal PASSED [  4%]
tests/models/test_contact.py::TestContactModel::test_contact_creation_all_fields PASSED [  4%]
tests/models/test_contact.py::TestContactModel::test_contact_required_fields PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_contact_relations PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_cannot_add_self_as_contact PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_duplicate_contact_not_allowed PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_contact_repr_and_to_dict PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_query_filters PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_long_nickname PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_with_null_action PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_date_format_and_precision PASSED [  7%]
tests/models/test_contact.py::TestContactModel::test_contact_delete_user_fails PASSED [  7%]
tests/models/test_note.py::TestNoteModel::test_note_creation PASSED      [  7%]
tests/models/test_note.py::TestNoteModel::test_note_default_values PASSED [  7%]
tests/models/test_note.py::TestNoteModel::test_note_content_required PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_creator_required PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_invalid_status PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_creator_relationship PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_assignments_relationship PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_note_deletion_cascade_creator PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_repr_truncates_content PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_to_dict_date_formats PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_to_details_dict_with_assignment PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_all_contacts PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_truncation_and_display PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_note_with_finished_date PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_query_filters PASSED      [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_empty_string_content PASSED [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_delete_date_marks_soft_delete PASSED [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_datetime_precision PASSED [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_invalid_type_raises PASSED [ 12%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_all_contacts_without_creator_as_current_user PASSED [ 12%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_three_or_less_assigned_users PASSED [ 12%]
tests/models/test_user.py::TestUserModel::test_user_creation PASSED      [ 12%]
tests/models/test_user.py::TestUserModel::test_user_creation_minimal_required_fields PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_username_unique_constraint PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_email_unique_constraint PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_password_hashing PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_to_dict PASSED       [ 14%]
tests/models/test_user.py::TestUserModel::test_user_repr PASSED          [ 14%]
tests/models/test_user.py::TestUserModel::test_user_contacts_relationship PASSED [ 14%]
tests/models/test_user.py::TestUserModel::test_user_created_notes_relationship PASSED [ 14%]
tests/models/test_user.py::TestUserModel::test_user_assignments_relationship PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_empty_username PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_empty_email PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_long_username PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_long_email PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_user_query_by_username PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_user_query_by_email PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_multiple_users_creation PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_user_validation_short_username PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_user_validation_invalid_email_format PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_user_validation_whitespace_trimming PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_username_length_bounds PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_email_length_bounds PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_email_case_insensitive_uniqueness PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_trim_and_lower_on_update PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_set_password_and_check_password PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_password_hash_blank_raises PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_created_date_is_timezone_aware_utc PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_username_unique_integrity_error PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_email_unique_integrity_error PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_contact_fk_integrity PASSED [ 20%]
tests/models/test_user.py::TestUserModel::test_update_username_to_existing_raises PASSED [ 20%]
tests/models/test_user.py::TestUserModel::test_update_email_invalid_format_raises PASSED [ 20%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_empty PASSED [ 20%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_with_logs PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_pagination PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_filter_by_user PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_filter_by_action_type PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_multiple_filters PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_success PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_not_found PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_stats_empty PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_stats_with_data PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_list_action_logs PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_list_action_logs PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_get_specific_log PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_get_specific_log PASSED [ 24%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_get_stats PASSED [ 24%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_get_stats PASSED [ 24%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_as_admin PASSED [ 24%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_as_regular_user PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_without_auth PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_all_notes_as_admin PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_all_notes_as_regular_user PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_get_stats_as_admin PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_get_stats_as_regular_user PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_user_as_admin PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_user_as_regular_user PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_nonexistent_user_as_admin PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_as_admin PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_as_regular_user PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_invalid_role PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_missing_role PASSED [ 28%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_nonexistent_user_role PASSED [ 28%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_get_any_note PASSED [ 28%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_update_any_note PASSED [ 28%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_delete_any_note PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_non_admin_cannot_use_admin_note_routes PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_list_all_contacts PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_get_any_contact PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_update_any_contact PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_delete_any_contact PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_non_admin_cannot_list_all_contacts PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_list_all_assignments PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_get_any_assignment PASSED [ 31%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_update_any_assignment PASSED [ 31%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_delete_any_assignment PASSED [ 31%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_non_admin_cannot_list_all_assignments PASSED [ 31%]
tests/routes/test_admin_extended.py::TestAdminNotesUpdate::test_admin_update_note_status_field PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminNotesUpdate::test_admin_update_note_important_only PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_recipient_priority PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_recipient_status PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_user_id PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_success PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_with_is_read PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_missing_note_id PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_missing_user_id PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_note_not_found PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_user_not_found PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_duplicate PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_list_assignments_empty PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_list_assignments_with_assignments PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_assignment_success PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_assignment_not_found PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_is_read PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_user_id PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_user_not_found PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_duplicate_user PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_not_found PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_delete_assignment_success PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_delete_assignment_not_found PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_success PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_forbidden_not_recipient PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_not_found PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_empty PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_with_unread PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_isolation PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_to_termine PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_to_en_cours PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_invalid_status PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_missing_status PASSED [ 40%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_forbidden_not_recipient PASSED [ 40%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_not_found PASSED [ 40%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_note_id PASSED [ 40%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_user_id PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_assigner_id PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_status PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_cannot_assign_to_non_contact PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_cannot_assign_to_non_mutual_contact PASSED [ 42%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_can_assign_to_mutual_contact PASSED [ 42%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_can_self_assign_without_contact PASSED [ 42%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_only_creator_can_assign PASSED [ 42%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_success PASSED  [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_username PASSED [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_email PASSED [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_password PASSED [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_duplicate_username PASSED [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_duplicate_email PASSED [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_empty_json PASSED [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_no_json PASSED  [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_success PASSED     [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_wrong_password PASSED [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_user_not_exists PASSED [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_missing_username PASSED [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_missing_password PASSED [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_empty_json PASSED  [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_no_json PASSED     [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_returns_valid_jwt PASSED [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_then_login_workflow PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_includes_self PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_with_added_contacts PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_empty_for_new_user PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_requires_auth PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_isolation PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_success PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_cannot_add_self PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_user_not_found PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_duplicate PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_missing_fields PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_requires_auth PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_users_includes_self PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_users_with_contacts PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_requires_auth PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_success PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_not_found PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_update_contact_success PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_update_contact_not_found PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_delete_contact_success PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_delete_contact_not_found PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_sent_and_received PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_sent PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_received PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_unread PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_pagination PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_empty PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_forbidden_not_own_contact PASSED [ 54%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_not_found PASSED [ 54%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_requires_auth PASSED [ 54%]
tests/routes/test_contacts_extended.py::TestContactNotesFilters::test_contact_notes_filter_important PASSED [ 54%]
tests/routes/test_contacts_extended.py::TestContactNotesFilters::test_contact_notes_pagination_limits PASSED [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_success PASSED      [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_requires_auth PASSED [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_with_invalid_token PASSED [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_logs_action PASSED  [ 56%]
tests/routes/test_logout.py::TestLogout::test_logout_multiple_times PASSED [ 56%]
tests/routes/test_logout.py::TestLogout::test_logout_then_access_protected_route PASSED [ 56%]
tests/routes/test_logout.py::TestLogoutWorkflow::test_login_logout_login_workflow PASSED [ 56%]
tests/routes/test_logout.py::TestLogoutWorkflow::test_register_auto_login_logout PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_success PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_with_all_fields PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_missing_content PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_requires_auth PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_empty PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_with_notes PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_requires_auth PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_success PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_not_found PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_requires_auth PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_success PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_with_assignment PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_not_found PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_requires_auth PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_success PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_missing_content PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_not_found PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_requires_auth PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_success PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_not_found PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_requires_auth PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_important PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_important_by_me PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_unread PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_received PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_sent PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_sort_date_asc PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_sort_important_first PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_default PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_custom_per_page PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_page_2 PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_last_page PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_max_per_page PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_invalid_values PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_as_creator PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_forbidden_not_creator PASSED [ 66%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_not_found PASSED [ 66%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_empty PASSED [ 66%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_by_creator_id PASSED [ 66%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_by_important_boolean PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_created_date_asc PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_important PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_invalid_fallback PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_in_progress PASSED [ 68%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_completed PASSED [ 68%]
tests/routes/test_notes_extended.py::TestNotesContentValidation::test_create_note_content_too_long PASSED [ 68%]
tests/routes/test_notes_extended.py::TestOrphanNotes::test_get_orphan_notes_empty PASSED [ 68%]
tests/routes/test_notes_extended.py::TestOrphanNotes::test_get_orphan_notes_with_orphans PASSED [ 69%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_only_creator PASSED [ 69%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_with_logs PASSED [ 69%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_empty PASSED [ 69%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_by_content PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_case_insensitive PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_partial_match PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_no_results PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_empty_query PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_with_spaces PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_combined_with_filters PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_combined_with_sorting PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_with_pagination PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_success PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_without_token PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_with_invalid_token PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_returns_correct_user PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_validates_token PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_structure PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestSearchAndAuthIntegration::test_search_only_returns_user_notes PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestSearchAndAuthIntegration::test_search_requires_authentication PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_list_users_empty PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_list_users_with_users PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_get_user_success PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_get_user_not_found PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_multiple_fields PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_empty PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_whitespace PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_duplicate PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_empty PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_whitespace PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_duplicate PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password_empty PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password_whitespace PASSED [ 78%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_not_found PASSED [ 78%]
tests/routes/test_users.py::TestUsersRoutes::test_delete_user_success PASSED [ 78%]
tests/routes/test_users.py::TestUsersRoutes::test_delete_user_not_found PASSED [ 78%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_list_users_requires_auth PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_get_user_requires_auth PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_own_profile PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_other_user_profile_forbidden PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_admin_can_update_any_profile PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_own_account PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_other_user_account_forbidden PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_admin_can_delete_any_account PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_requires_auth PASSED [ 81%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_requires_auth PASSED [ 81%]
tests/test_app.py::TestAppBasics::test_health_check PASSED               [ 81%]
tests/test_app.py::TestAppBasics::test_invalid_route_returns_404 PASSED  [ 81%]
tests/test_app.py::TestAppBasics::test_expired_token_handled PASSED      [ 82%]
tests/test_app.py::TestAppBasics::test_invalid_token_handled PASSED      [ 82%]
tests/test_app.py::TestAppBasics::test_missing_token_handled PASSED      [ 82%]
tests/test_decorators_edge_cases.py::TestAdminDecorator::test_admin_decorator_with_deleted_user PASSED [ 82%]
tests/test_decorators_edge_cases.py::TestUsersUpdateValidation::test_update_other_user_as_non_admin PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_valid_email_accepted PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_email_normalized_to_lowercase PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_invalid_email_rejected PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_email_without_at_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_email_without_domain_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_email_with_multiple_at_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_empty_email_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_whitespace_only_email_rejected PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidation::test_email_with_spaces_trimmed PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidation::test_complex_valid_email_accepted PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_valid_email PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_invalid_email PASSED [ 86%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_normalizes_email PASSED [ 86%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_email_missing_domain PASSED [ 86%]
tests/test_mutual_contacts.py::TestMutualContacts::test_contact_is_mutual_returns_true_when_reciprocal PASSED [ 86%]
tests/test_mutual_contacts.py::TestMutualContacts::test_contact_is_mutual_returns_false_when_not_reciprocal PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContacts::test_contact_to_dict_includes_is_mutual PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_get_contacts_includes_is_mutual_field PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_get_assignable_includes_is_mutual_field PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_cannot_assign_note_to_non_mutual_contact PASSED [ 88%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_can_assign_note_to_mutual_contact PASSED [ 88%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_can_self_assign_without_mutual_contact PASSED [ 88%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_opening_note_marks_assignment_as_read PASSED [ 88%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_opening_note_sets_read_date PASSED [ 89%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_opening_already_read_note_does_not_change_is_read PASSED [ 89%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_creator_opening_own_note_does_not_affect_assignment PASSED [ 89%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByCreator::test_creator_can_delete_note PASSED [ 89%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByCreator::test_creator_deleted_by_in_details PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByRecipient::test_recipient_can_delete_assigned_note PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByRecipient::test_recipient_deleted_by_shows_recipient_id PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionAuthorization::test_non_creator_non_recipient_cannot_delete PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionTraceability::test_creator_deletion_traceable PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionTraceability::test_recipient_deletion_different_from_creator PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_creator_sees_deleted_by_info PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_recipient_does_not_see_deleted_by_info PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_other_recipient_does_not_see_deleted_by_info PASSED [ 92%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_creator_sees_own_deletion PASSED [ 92%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_recipient_sees_creator_deletion PASSED [ 92%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_recipient_does_not_see_other_recipient_deletion PASSED [ 92%]
tests/test_rate_limiting_cors.py::TestRateLimiting::test_rate_limiting_is_configured PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestRateLimiting::test_register_endpoint_has_rate_limit_decorator PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestRateLimiting::test_login_endpoint_has_rate_limit_decorator PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_headers_present_on_options PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_headers_present_on_get PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_configured_origin PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_credentials PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_required_methods PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_required_headers PASSED [ 95%]
tests/test_security_isolation.py::TestNotesIsolation::test_cannot_update_other_user_note PASSED [ 95%]
tests/test_security_isolation.py::TestNotesIsolation::test_cannot_delete_other_user_note PASSED [ 95%]
tests/test_security_isolation.py::TestNotesIsolation::test_creator_can_update_own_note PASSED [ 95%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_view_other_user_contact PASSED [ 96%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_update_other_user_contact PASSED [ 96%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_delete_other_user_contact PASSED [ 96%]
tests/test_security_isolation.py::TestContactsIsolation::test_owner_can_update_own_contact PASSED [ 96%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_cannot_view_unrelated_assignment PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_creator_can_view_assignment PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_recipient_can_view_assignment PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_recipient_cannot_change_assignment_user PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_only_creator_can_delete_assignment PASSED [ 98%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_third_party_cannot_delete_assignment PASSED [ 98%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_cannot_add_same_contact_twice PASSED [ 98%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_can_add_reciprocal_contacts PASSED [ 98%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_can_add_different_contacts_for_same_user PASSED [ 99%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_cannot_assign_same_note_to_user_twice PASSED [ 99%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_can_assign_same_note_to_different_users PASSED [ 99%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_can_assign_different_notes_to_same_user PASSED [100%]

---------- coverage: platform linux, python 3.11.14-final-0 ----------
Name                           Stmts   Miss  Cover   Missing
------------------------------------------------------------
app/__init__.py                   58      1    98%   111
app/decorators.py                 18      0   100%
app/models/__init__.py             6      0   100%
app/models/action_log.py          15      0   100%
app/models/assignment.py          20      0   100%
app/models/contact.py             20      0   100%
app/models/note.py                34      0   100%
app/models/user.py                51      1    98%   57
app/routes/__init__.py             0      0   100%
app/routes/v1/__init__.py          6      0   100%
app/routes/v1/action_logs.py      35      0   100%
app/routes/v1/admin.py           144      0   100%
app/routes/v1/assignments.py     154      1    99%   129
app/routes/v1/auth.py             61      1    98%   31
app/routes/v1/contacts.py        131      2    98%   294, 296
app/routes/v1/notes.py           205      6    97%   158, 173, 208, 347, 473-474
app/routes/v1/users.py            78     12    85%   19-21, 73-93
------------------------------------------------------------
TOTAL                           1036     24    98%
Coverage HTML written to dir htmlcov


================ 398 passed, 245 warnings in 117.33s (0:01:57) =================

============================================
üéØ SUITE COMPL√àTE DE TESTS
============================================
============================= test session starts ==============================
platform linux -- Python 3.11.14, pytest-8.0.0, pluggy-1.6.0 -- /usr/local/bin/python3.11
cachedir: .pytest_cache
rootdir: /app
configfile: pytest.ini
plugins: cov-4.0.0, flask-1.3.0
collecting ... collected 398 items

tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_complete_note_collaboration_workflow PASSED [  0%]
tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_note_lifecycle_complete PASSED [  0%]
tests/e2e/test_workflows.py::TestNoteCollaborationWorkflows::test_multiple_assignments_workflow PASSED [  0%]
tests/e2e/test_workflows.py::TestUserIsolationWorkflows::test_complete_user_isolation PASSED [  1%]
tests/e2e/test_workflows.py::TestUserIsolationWorkflows::test_contact_isolation_workflow PASSED [  1%]
tests/e2e/test_workflows.py::TestErrorHandlingWorkflows::test_workflow_with_invalid_operations PASSED [  1%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_exchange_workflow PASSED [  1%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_pagination_workflow PASSED [  2%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_unread_filter_workflow FAILED [  2%]
tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_empty_exchange_workflow PASSED [  2%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_creation_minimal_required_fields PASSED [  2%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_missing_fields PASSED [  3%]
tests/models/test_action_log.py::TestActionLogModel::test_action_log_relation_and_to_dict PASSED [  3%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_creation_minimal_required_fields PASSED [  3%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_note_user_required PASSED [  3%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_relations PASSED [  4%]
tests/models/test_assignment.py::TestAssignmentModel::test_assignment_to_dict_and_repr PASSED [  4%]
tests/models/test_contact.py::TestContactModel::test_contact_creation_minimal PASSED [  4%]
tests/models/test_contact.py::TestContactModel::test_contact_creation_all_fields PASSED [  4%]
tests/models/test_contact.py::TestContactModel::test_contact_required_fields PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_contact_relations PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_cannot_add_self_as_contact PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_duplicate_contact_not_allowed PASSED [  5%]
tests/models/test_contact.py::TestContactModel::test_contact_repr_and_to_dict PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_query_filters PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_long_nickname PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_with_null_action PASSED [  6%]
tests/models/test_contact.py::TestContactModel::test_contact_date_format_and_precision PASSED [  7%]
tests/models/test_contact.py::TestContactModel::test_contact_delete_user_fails PASSED [  7%]
tests/models/test_note.py::TestNoteModel::test_note_creation PASSED      [  7%]
tests/models/test_note.py::TestNoteModel::test_note_default_values PASSED [  7%]
tests/models/test_note.py::TestNoteModel::test_note_content_required PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_creator_required PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_invalid_status PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_creator_relationship PASSED [  8%]
tests/models/test_note.py::TestNoteModel::test_note_assignments_relationship PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_note_deletion_cascade_creator PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_repr_truncates_content PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_to_dict_date_formats PASSED [  9%]
tests/models/test_note.py::TestNoteModel::test_to_details_dict_with_assignment PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_all_contacts PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_truncation_and_display PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_note_with_finished_date PASSED [ 10%]
tests/models/test_note.py::TestNoteModel::test_query_filters PASSED      [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_empty_string_content PASSED [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_delete_date_marks_soft_delete PASSED [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_datetime_precision PASSED [ 11%]
tests/models/test_note.py::TestNoteModel::test_note_invalid_type_raises PASSED [ 12%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_all_contacts_without_creator_as_current_user PASSED [ 12%]
tests/models/test_note.py::TestNoteModel::test_to_summary_dict_three_or_less_assigned_users PASSED [ 12%]
tests/models/test_user.py::TestUserModel::test_user_creation PASSED      [ 12%]
tests/models/test_user.py::TestUserModel::test_user_creation_minimal_required_fields PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_username_unique_constraint PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_email_unique_constraint PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_password_hashing PASSED [ 13%]
tests/models/test_user.py::TestUserModel::test_user_to_dict PASSED       [ 14%]
tests/models/test_user.py::TestUserModel::test_user_repr PASSED          [ 14%]
tests/models/test_user.py::TestUserModel::test_user_contacts_relationship PASSED [ 14%]
tests/models/test_user.py::TestUserModel::test_user_created_notes_relationship PASSED [ 14%]
tests/models/test_user.py::TestUserModel::test_user_assignments_relationship PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_empty_username PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_empty_email PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_long_username PASSED [ 15%]
tests/models/test_user.py::TestUserModel::test_user_validation_long_email PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_user_query_by_username PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_user_query_by_email PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_multiple_users_creation PASSED [ 16%]
tests/models/test_user.py::TestUserModel::test_user_validation_short_username PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_user_validation_invalid_email_format PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_user_validation_whitespace_trimming PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_username_length_bounds PASSED [ 17%]
tests/models/test_user.py::TestUserModel::test_email_length_bounds PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_email_case_insensitive_uniqueness PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_trim_and_lower_on_update PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_set_password_and_check_password PASSED [ 18%]
tests/models/test_user.py::TestUserModel::test_password_hash_blank_raises PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_created_date_is_timezone_aware_utc PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_username_unique_integrity_error PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_email_unique_integrity_error PASSED [ 19%]
tests/models/test_user.py::TestUserModel::test_contact_fk_integrity PASSED [ 20%]
tests/models/test_user.py::TestUserModel::test_update_username_to_existing_raises PASSED [ 20%]
tests/models/test_user.py::TestUserModel::test_update_email_invalid_format_raises PASSED [ 20%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_empty PASSED [ 20%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_with_logs PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_pagination PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_filter_by_user PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_filter_by_action_type PASSED [ 21%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_list_action_logs_multiple_filters PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_success PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_not_found PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_stats_empty PASSED [ 22%]
tests/routes/test_action_logs.py::TestActionLogsRoutes::test_get_action_log_stats_with_data PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_list_action_logs PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_list_action_logs PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_get_specific_log PASSED [ 23%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_get_specific_log PASSED [ 24%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_non_admin_cannot_get_stats PASSED [ 24%]
tests/routes/test_action_logs_security.py::TestActionLogsAdminOnly::test_admin_can_get_stats PASSED [ 24%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_as_admin PASSED [ 24%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_as_regular_user PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_users_without_auth PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_all_notes_as_admin PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_list_all_notes_as_regular_user PASSED [ 25%]
tests/routes/test_admin.py::TestAdminRoutes::test_get_stats_as_admin PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_get_stats_as_regular_user PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_user_as_admin PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_user_as_regular_user PASSED [ 26%]
tests/routes/test_admin.py::TestAdminRoutes::test_delete_nonexistent_user_as_admin PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_as_admin PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_as_regular_user PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_invalid_role PASSED [ 27%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_user_role_missing_role PASSED [ 28%]
tests/routes/test_admin.py::TestAdminRoutes::test_update_nonexistent_user_role PASSED [ 28%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_get_any_note PASSED [ 28%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_update_any_note PASSED [ 28%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_admin_can_delete_any_note PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminNotesCRUD::test_non_admin_cannot_use_admin_note_routes PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_list_all_contacts PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_get_any_contact PASSED [ 29%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_update_any_contact PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_admin_can_delete_any_contact PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminContactsCRUD::test_non_admin_cannot_list_all_contacts PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_list_all_assignments PASSED [ 30%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_get_any_assignment PASSED [ 31%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_update_any_assignment FAILED [ 31%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_delete_any_assignment PASSED [ 31%]
tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_non_admin_cannot_list_all_assignments PASSED [ 31%]
tests/routes/test_admin_extended.py::TestAdminNotesUpdate::test_admin_update_note_status_field PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminNotesUpdate::test_admin_update_note_important_only PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_recipient_priority PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_recipient_status PASSED [ 32%]
tests/routes/test_admin_extended.py::TestAdminAssignmentsUpdate::test_admin_update_assignment_user_id PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_success PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_with_is_read PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_missing_note_id PASSED [ 33%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_missing_user_id PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_note_not_found PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_user_not_found PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_create_assignment_duplicate PASSED [ 34%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_list_assignments_empty PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_list_assignments_with_assignments PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_assignment_success PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_assignment_not_found PASSED [ 35%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_is_read PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_user_id PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_user_not_found PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_duplicate_user PASSED [ 36%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_assignment_not_found PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_delete_assignment_success PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_delete_assignment_not_found PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_success PASSED [ 37%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_forbidden_not_recipient PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_toggle_priority_not_found PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_empty PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_with_unread PASSED [ 38%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_get_unread_assignments_isolation PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_to_termine PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_to_en_cours PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_invalid_status PASSED [ 39%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_missing_status PASSED [ 40%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_forbidden_not_recipient PASSED [ 40%]
tests/routes/test_assignments.py::TestAssignmentsRoutes::test_update_status_not_found PASSED [ 40%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_note_id PASSED [ 40%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_user_id PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_assigner_id PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsFilters::test_list_assignments_filter_by_status PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_cannot_assign_to_non_contact PASSED [ 41%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_cannot_assign_to_non_mutual_contact PASSED [ 42%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_can_assign_to_mutual_contact PASSED [ 42%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_can_self_assign_without_contact PASSED [ 42%]
tests/routes/test_assignments_extended.py::TestAssignmentsMutualContactValidation::test_only_creator_can_assign PASSED [ 42%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_success PASSED  [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_username PASSED [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_email PASSED [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_missing_password PASSED [ 43%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_duplicate_username PASSED [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_duplicate_email PASSED [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_empty_json PASSED [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_no_json PASSED  [ 44%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_success PASSED     [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_wrong_password PASSED [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_user_not_exists PASSED [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_missing_username PASSED [ 45%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_missing_password PASSED [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_empty_json PASSED  [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_no_json PASSED     [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_login_returns_valid_jwt PASSED [ 46%]
tests/routes/test_auth.py::TestAuthRoutes::test_register_then_login_workflow PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_includes_self PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_with_added_contacts PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_empty_for_new_user PASSED [ 47%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_requires_auth PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_contacts_isolation PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_success PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_cannot_add_self PASSED [ 48%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_user_not_found PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_duplicate PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_missing_fields PASSED [ 49%]
tests/routes/test_contacts.py::TestContactsRoutes::test_create_contact_requires_auth PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_users_includes_self PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_users_with_contacts PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_list_assignable_requires_auth PASSED [ 50%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_success PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_not_found PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_update_contact_success PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_update_contact_not_found PASSED [ 51%]
tests/routes/test_contacts.py::TestContactsRoutes::test_delete_contact_success PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_delete_contact_not_found PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_sent_and_received PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_sent PASSED [ 52%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_received PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_filter_unread PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_pagination PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_empty PASSED [ 53%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_forbidden_not_own_contact PASSED [ 54%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_not_found PASSED [ 54%]
tests/routes/test_contacts.py::TestContactsRoutes::test_get_contact_notes_requires_auth PASSED [ 54%]
tests/routes/test_contacts_extended.py::TestContactNotesFilters::test_contact_notes_filter_important PASSED [ 54%]
tests/routes/test_contacts_extended.py::TestContactNotesFilters::test_contact_notes_pagination_limits PASSED [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_success PASSED      [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_requires_auth PASSED [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_with_invalid_token PASSED [ 55%]
tests/routes/test_logout.py::TestLogout::test_logout_logs_action PASSED  [ 56%]
tests/routes/test_logout.py::TestLogout::test_logout_multiple_times PASSED [ 56%]
tests/routes/test_logout.py::TestLogout::test_logout_then_access_protected_route PASSED [ 56%]
tests/routes/test_logout.py::TestLogoutWorkflow::test_login_logout_login_workflow PASSED [ 56%]
tests/routes/test_logout.py::TestLogoutWorkflow::test_register_auto_login_logout PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_success PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_with_all_fields PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_missing_content PASSED [ 57%]
tests/routes/test_notes.py::TestNotesRoutes::test_create_note_requires_auth PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_empty PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_with_notes PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_requires_auth PASSED [ 58%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_success PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_not_found PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_requires_auth PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_success PASSED [ 59%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_with_assignment PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_not_found PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_details_requires_auth PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_success PASSED [ 60%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_missing_content PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_not_found PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_update_note_requires_auth PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_success PASSED [ 61%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_not_found PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_delete_note_requires_auth PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_important PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_important_by_me PASSED [ 62%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_unread PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_received PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_filter_sent PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_sort_date_asc PASSED [ 63%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_sort_important_first PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_default PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_custom_per_page PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_page_2 PASSED [ 64%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_last_page PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_max_per_page PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_list_notes_pagination_invalid_values PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_as_creator PASSED [ 65%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_forbidden_not_creator PASSED [ 66%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_not_found PASSED [ 66%]
tests/routes/test_notes.py::TestNotesRoutes::test_get_note_assignments_empty PASSED [ 66%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_by_creator_id PASSED [ 66%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_by_important_boolean PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_created_date_asc PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_important PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_sort_by_invalid_fallback PASSED [ 67%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_in_progress PASSED [ 68%]
tests/routes/test_notes_extended.py::TestNotesExtendedFilters::test_filter_completed PASSED [ 68%]
tests/routes/test_notes_extended.py::TestNotesContentValidation::test_create_note_content_too_long PASSED [ 68%]
tests/routes/test_notes_extended.py::TestOrphanNotes::test_get_orphan_notes_empty PASSED [ 68%]
tests/routes/test_notes_extended.py::TestOrphanNotes::test_get_orphan_notes_with_orphans PASSED [ 69%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_only_creator PASSED [ 69%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_with_logs PASSED [ 69%]
tests/routes/test_notes_extended.py::TestNotesDeletionHistory::test_deletion_history_empty PASSED [ 69%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_by_content PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_case_insensitive PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_partial_match PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_no_results PASSED [ 70%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_empty_query PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_notes_with_spaces PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_combined_with_filters PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_combined_with_sorting PASSED [ 71%]
tests/routes/test_search_and_auth_me.py::TestSearchNotes::test_search_with_pagination PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_success PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_without_token PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_with_invalid_token PASSED [ 72%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_returns_correct_user PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_validates_token PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestAuthMe::test_get_me_structure PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestSearchAndAuthIntegration::test_search_only_returns_user_notes PASSED [ 73%]
tests/routes/test_search_and_auth_me.py::TestSearchAndAuthIntegration::test_search_requires_authentication PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_list_users_empty PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_list_users_with_users PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_get_user_success PASSED [ 74%]
tests/routes/test_users.py::TestUsersRoutes::test_get_user_not_found PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password PASSED [ 75%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_multiple_fields PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_empty PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_whitespace PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_username_duplicate PASSED [ 76%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_empty PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_whitespace PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_email_duplicate PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password_empty PASSED [ 77%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_password_whitespace PASSED [ 78%]
tests/routes/test_users.py::TestUsersRoutes::test_update_user_not_found PASSED [ 78%]
tests/routes/test_users.py::TestUsersRoutes::test_delete_user_success PASSED [ 78%]
tests/routes/test_users.py::TestUsersRoutes::test_delete_user_not_found PASSED [ 78%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_list_users_requires_auth PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_get_user_requires_auth PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_own_profile PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_other_user_profile_forbidden PASSED [ 79%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_admin_can_update_any_profile PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_own_account PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_other_user_account_forbidden PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_admin_can_delete_any_account PASSED [ 80%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_update_requires_auth PASSED [ 81%]
tests/routes/test_users_security.py::TestUsersSecurityRoutes::test_delete_requires_auth PASSED [ 81%]
tests/test_app.py::TestAppBasics::test_health_check PASSED               [ 81%]
tests/test_app.py::TestAppBasics::test_invalid_route_returns_404 PASSED  [ 81%]
tests/test_app.py::TestAppBasics::test_expired_token_handled PASSED      [ 82%]
tests/test_app.py::TestAppBasics::test_invalid_token_handled PASSED      [ 82%]
tests/test_app.py::TestAppBasics::test_missing_token_handled PASSED      [ 82%]
tests/test_decorators_edge_cases.py::TestAdminDecorator::test_admin_decorator_with_deleted_user PASSED [ 82%]
tests/test_decorators_edge_cases.py::TestUsersUpdateValidation::test_update_other_user_as_non_admin PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_valid_email_accepted PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_email_normalized_to_lowercase PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_invalid_email_rejected PASSED [ 83%]
tests/test_email_validation.py::TestEmailValidation::test_email_without_at_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_email_without_domain_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_email_with_multiple_at_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_empty_email_rejected PASSED [ 84%]
tests/test_email_validation.py::TestEmailValidation::test_whitespace_only_email_rejected PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidation::test_email_with_spaces_trimmed PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidation::test_complex_valid_email_accepted PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_valid_email PASSED [ 85%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_invalid_email PASSED [ 86%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_normalizes_email PASSED [ 86%]
tests/test_email_validation.py::TestEmailValidationInRegistration::test_registration_with_email_missing_domain PASSED [ 86%]
tests/test_mutual_contacts.py::TestMutualContacts::test_contact_is_mutual_returns_true_when_reciprocal PASSED [ 86%]
tests/test_mutual_contacts.py::TestMutualContacts::test_contact_is_mutual_returns_false_when_not_reciprocal PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContacts::test_contact_to_dict_includes_is_mutual PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_get_contacts_includes_is_mutual_field PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_get_assignable_includes_is_mutual_field PASSED [ 87%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_cannot_assign_note_to_non_mutual_contact PASSED [ 88%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_can_assign_note_to_mutual_contact PASSED [ 88%]
tests/test_mutual_contacts.py::TestMutualContactsAPI::test_can_self_assign_without_mutual_contact PASSED [ 88%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_opening_note_marks_assignment_as_read PASSED [ 88%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_opening_note_sets_read_date PASSED [ 89%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_opening_already_read_note_does_not_change_is_read PASSED [ 89%]
tests/test_mutual_contacts.py::TestAutoMarkAsRead::test_creator_opening_own_note_does_not_affect_assignment PASSED [ 89%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByCreator::test_creator_can_delete_note PASSED [ 89%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByCreator::test_creator_deleted_by_in_details PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByRecipient::test_recipient_can_delete_assigned_note PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionByRecipient::test_recipient_deleted_by_shows_recipient_id PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionAuthorization::test_non_creator_non_recipient_cannot_delete PASSED [ 90%]
tests/test_note_deletion_traceability.py::TestNoteDeletionTraceability::test_creator_deletion_traceable PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionTraceability::test_recipient_deletion_different_from_creator PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_creator_sees_deleted_by_info PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_recipient_does_not_see_deleted_by_info PASSED [ 91%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_other_recipient_does_not_see_deleted_by_info PASSED [ 92%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_creator_sees_own_deletion PASSED [ 92%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_recipient_sees_creator_deletion PASSED [ 92%]
tests/test_note_deletion_traceability.py::TestNoteDeletionConfidentiality::test_recipient_does_not_see_other_recipient_deletion PASSED [ 92%]
tests/test_rate_limiting_cors.py::TestRateLimiting::test_rate_limiting_is_configured PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestRateLimiting::test_register_endpoint_has_rate_limit_decorator PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestRateLimiting::test_login_endpoint_has_rate_limit_decorator PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_headers_present_on_options PASSED [ 93%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_headers_present_on_get PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_configured_origin PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_credentials PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_required_methods PASSED [ 94%]
tests/test_rate_limiting_cors.py::TestCORS::test_cors_allows_required_headers PASSED [ 95%]
tests/test_security_isolation.py::TestNotesIsolation::test_cannot_update_other_user_note PASSED [ 95%]
tests/test_security_isolation.py::TestNotesIsolation::test_cannot_delete_other_user_note PASSED [ 95%]
tests/test_security_isolation.py::TestNotesIsolation::test_creator_can_update_own_note PASSED [ 95%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_view_other_user_contact PASSED [ 96%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_update_other_user_contact PASSED [ 96%]
tests/test_security_isolation.py::TestContactsIsolation::test_cannot_delete_other_user_contact PASSED [ 96%]
tests/test_security_isolation.py::TestContactsIsolation::test_owner_can_update_own_contact PASSED [ 96%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_cannot_view_unrelated_assignment PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_creator_can_view_assignment PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_recipient_can_view_assignment PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_recipient_cannot_change_assignment_user PASSED [ 97%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_only_creator_can_delete_assignment PASSED [ 98%]
tests/test_security_isolation.py::TestAssignmentsIsolation::test_third_party_cannot_delete_assignment PASSED [ 98%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_cannot_add_same_contact_twice PASSED [ 98%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_can_add_reciprocal_contacts PASSED [ 98%]
tests/test_unique_constraints.py::TestContactUniqueConstraint::test_can_add_different_contacts_for_same_user PASSED [ 99%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_cannot_assign_same_note_to_user_twice PASSED [ 99%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_can_assign_same_note_to_different_users PASSED [ 99%]
tests/test_unique_constraints.py::TestAssignmentUniqueConstraint::test_can_assign_different_notes_to_same_user PASSED [100%]

=================================== FAILURES ===================================
_____ TestContactNotesWorkflows.test_contact_notes_unread_filter_workflow ______
tests/e2e/test_workflows.py:972: in test_contact_notes_unread_filter_workflow
    assert response.status_code == 201
E   assert 401 == 201
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
________ TestAdminAssignmentsCRUD.test_admin_can_update_any_assignment _________
tests/routes/test_admin_crud.py:206: in test_admin_can_update_any_assignment
    assert response.status_code == 200
E   assert 401 == 200
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code

---------- coverage: platform linux, python 3.11.14-final-0 ----------
Name                           Stmts   Miss  Cover   Missing
------------------------------------------------------------
app/__init__.py                   58      1    98%   111
app/decorators.py                 18      0   100%
app/models/__init__.py             6      0   100%
app/models/action_log.py          15      0   100%
app/models/assignment.py          20      0   100%
app/models/contact.py             20      0   100%
app/models/note.py                34      0   100%
app/models/user.py                51      1    98%   57
app/routes/__init__.py             0      0   100%
app/routes/v1/__init__.py          6      0   100%
app/routes/v1/action_logs.py      35      0   100%
app/routes/v1/admin.py           144      1    99%   245
app/routes/v1/assignments.py     154      1    99%   129
app/routes/v1/auth.py             61      1    98%   31
app/routes/v1/contacts.py        131      2    98%   294, 296
app/routes/v1/notes.py           205      6    97%   158, 173, 208, 347, 473-474
app/routes/v1/users.py            78     12    85%   19-21, 73-93
------------------------------------------------------------
TOTAL                           1036     25    98%
Coverage HTML written to dir htmlcov

=========================== short test summary info ============================
FAILED tests/e2e/test_workflows.py::TestContactNotesWorkflows::test_contact_notes_unread_filter_workflow
FAILED tests/routes/test_admin_crud.py::TestAdminAssignmentsCRUD::test_admin_can_update_any_assignment
=========== 2 failed, 396 passed, 240 warnings in 124.09s (0:02:04) ============

============================================
‚úÖ TOUS LES TESTS PASSENT
============================================

============================================
üèÜ SCORE FINAL
============================================

üìä Statistiques:
  - Tests r√©ussis: 396
  - Tests √©chou√©s: 2
  - Couverture de code: 8%

üéØ Taux de r√©ussite: 99.49%

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   SCORE FINAL: 72.04/100   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

============================================
üìÅ Fichiers g√©n√©r√©s:
  - Rapport texte: test_results_20251030_141345.txt
  - Couverture HTML: backend/htmlcov/index.html
============================================
